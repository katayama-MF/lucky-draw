*{margin:0;padding:0;box-sizing:border-box;}
:root{
  --bg:#06060F;--card:#0D0D1A;--border:#1A1A2E;
  --cyan:#00E5FF;--gold:#FFD93D;--magenta:#FF2D78;--purple:#A855F7;--green:#34D399;
  --text:#E8E8F0;--text-dim:#6B6B80;
}
html,body{min-height:100%;background:var(--bg);color:var(--text);font-family:'Zen Maru Gothic',sans-serif;}
.container{
  position:relative;width:100vw;min-height:100vh;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  overflow:visible;
}

/* Background - 3D Cosmic Space */
.bg-space{
  position:fixed;inset:0;overflow:hidden;pointer-events:none;
  perspective:800px;perspective-origin:50% 50%;
  background:radial-gradient(ellipse at 50% 50%,#0a0a20 0%,#04040c 60%,#000003 100%);
}
/* Star layers with parallax depth */
.star-layer{position:absolute;inset:-50%;pointer-events:none;}
.star-layer.far{animation:starDrift 120s linear infinite;opacity:0.5;}
.star-layer.mid{animation:starDrift 80s linear infinite;opacity:0.7;}
.star-layer.near{animation:starDrift 50s linear infinite;opacity:1.0;}
@keyframes starDrift{0%{transform:translateZ(0) translateY(0);}100%{transform:translateZ(0) translateY(-15%);}}
.star{position:absolute;border-radius:50%;background:#fff;}
.star.twinkle{animation:twinkle ease-in-out infinite;}
@keyframes twinkle{0%,100%{opacity:0.3;transform:scale(0.8);}50%{opacity:1;transform:scale(1.2);}}

/* Nebula clouds - deep space gas */
.nebula{position:fixed;border-radius:50%;pointer-events:none;mix-blend-mode:screen;}
.nebula.n1{width:600px;height:400px;background:radial-gradient(ellipse,rgba(0,229,255,0.08) 0%,rgba(0,229,255,0.02) 40%,transparent 70%);top:-5%;left:-10%;filter:blur(60px);animation:nebulaPulse 15s ease-in-out infinite;}
.nebula.n2{width:500px;height:500px;background:radial-gradient(ellipse,rgba(168,85,247,0.07) 0%,rgba(168,85,247,0.02) 40%,transparent 70%);bottom:-10%;right:-5%;filter:blur(70px);animation:nebulaPulse 20s ease-in-out infinite 5s;}
.nebula.n3{width:400px;height:300px;background:radial-gradient(ellipse,rgba(255,45,120,0.05) 0%,rgba(255,45,120,0.01) 40%,transparent 70%);top:40%;left:30%;filter:blur(80px);animation:nebulaPulse 18s ease-in-out infinite 8s;}
.nebula.n4{width:500px;height:350px;background:radial-gradient(ellipse,rgba(255,217,61,0.04) 0%,transparent 60%);top:10%;right:20%;filter:blur(90px);animation:nebulaPulse 22s ease-in-out infinite 12s;}
@keyframes nebulaPulse{0%,100%{opacity:0.6;transform:scale(1) rotate(0deg);}50%{opacity:1;transform:scale(1.1) rotate(3deg);}}

/* Shooting stars */
.shooting-star{
  position:fixed;height:2px;
  pointer-events:none;opacity:0;z-index:5;
  border-radius:1px;
}
.shooting-star .ss-head{
  position:absolute;right:0;top:50%;transform:translateY(-50%);
  width:4px;height:4px;border-radius:50%;
  background:#fff;
  box-shadow:0 0 6px 2px currentColor;
}
.shooting-star .ss-tail{
  width:100%;height:100%;
  background:linear-gradient(to right,transparent 0%,currentColor 60%,#fff 100%);
  border-radius:1px;
}

/* Floating cosmic dust particles */
.cosmic-dust{position:fixed;inset:0;pointer-events:none;overflow:hidden;}
.dust{position:absolute;border-radius:50%;opacity:0;animation:dustFloat linear infinite;}
@keyframes dustFloat{
  0%{transform:translate3d(0,100vh,0) scale(0.5);opacity:0;}
  10%{opacity:0.8;}
  90%{opacity:0.6;}
  100%{transform:translate3d(var(--dx),-20vh,var(--dz)) scale(1);opacity:0;}
}

/* Depth grid floor (perspective) */
.bg-grid-3d{
  position:fixed;left:-50%;right:-50%;bottom:-30%;height:80%;
  pointer-events:none;
  background-image:
    linear-gradient(rgba(0,229,255,0.04) 1px,transparent 1px),
    linear-gradient(90deg,rgba(0,229,255,0.04) 1px,transparent 1px);
  background-size:60px 60px;
  transform:perspective(400px) rotateX(60deg);
  transform-origin:center top;
  mask-image:linear-gradient(to top,rgba(0,0,0,0.4) 0%,transparent 70%);
  -webkit-mask-image:linear-gradient(to top,rgba(0,0,0,0.4) 0%,transparent 70%);
  animation:gridScroll 8s linear infinite;
}
@keyframes gridScroll{0%{background-position:0 0;}100%{background-position:0 60px;}}

/* Rush screen edge glow */
.rush-vignette{
  position:fixed;inset:0;pointer-events:none;z-index:5;
  opacity:0;transition:opacity 0.5s;
}
.rush-vignette.big{
  opacity:1;
  box-shadow:inset 0 0 120px rgba(0,229,255,0.08),inset 0 0 250px rgba(0,229,255,0.03);
  animation:rushPulseBig 2s ease-in-out infinite;
}
.rush-vignette.super{
  opacity:1;
  box-shadow:inset 0 0 150px rgba(255,217,61,0.12),inset 0 0 300px rgba(255,140,0,0.05);
  animation:rushPulseSuper 1.5s ease-in-out infinite;
}
.rush-vignette.mega{
  opacity:1;
  box-shadow:inset 0 0 180px rgba(255,45,120,0.15),inset 0 0 350px rgba(168,85,247,0.08);
  animation:rushPulseMega 1s ease-in-out infinite;
}
@keyframes rushPulseBig{0%,100%{opacity:0.5;}50%{opacity:1;}}
@keyframes rushPulseSuper{0%,100%{opacity:0.6;}50%{opacity:1;}}
@keyframes rushPulseMega{0%,100%{opacity:0.7;}50%{opacity:1;}}

/* Warp Speed Effect (Star Wars hyperspace) */
.warp-container{
  position:fixed;inset:0;pointer-events:none;z-index:5;
  display:none;overflow:hidden;
}
.warp-container.active{display:block;}
.warp-line{
  position:absolute;
  left:50%;top:50%;
  width:2px;height:0;
  transform-origin:0 0;
  border-radius:1px;
  opacity:0;
}
@keyframes warpStreak{
  0%{height:0;opacity:0;}
  5%{opacity:0.9;}
  60%{height:var(--wl);opacity:0.8;}
  100%{height:calc(var(--wl)*3);opacity:0;}
}
.warp-container .warp-flash{
  position:fixed;inset:0;background:radial-gradient(circle at center,rgba(255,255,255,0.3),transparent 70%);
  opacity:0;animation:warpFlash 0.4s ease-out forwards;
}
@keyframes warpFlash{0%{opacity:0;}20%{opacity:1;}100%{opacity:0;}}

/* Lightning Effect */
.lightning-container{
  position:fixed;inset:0;pointer-events:none;z-index:5;
  overflow:hidden;
}
.lightning-bolt{
  position:absolute;
  opacity:0;
  filter:blur(1px);
  box-shadow:0 0 10px currentColor,0 0 20px currentColor;
}
@keyframes lightningFlash{
  0%{opacity:0;transform:rotate(var(--angle,0deg)) scaleY(0);}
  10%{opacity:1;transform:rotate(var(--angle,0deg)) scaleY(1);}
  20%{opacity:0.3;}
  30%{opacity:1;}
  40%{opacity:0.2;}
  50%{opacity:0.9;}
  60%{opacity:0;}
  100%{opacity:0;transform:rotate(var(--angle,0deg)) scaleY(1);}
}

/* Screen Shake */
.screen-shake{
  position:fixed;inset:0;pointer-events:none;z-index:1;
}

/* Header */
.header{
  position:fixed;top:0;left:0;right:0;
  display:flex;align-items:center;justify-content:space-between;
  padding:16px 24px;z-index:10;
  background:rgba(6,6,15,0.7);backdrop-filter:blur(14px);
}
.header-left{display:flex;align-items:center;gap:16px;}
.header-brand-event{display:flex;flex-direction:column;gap:2px;}
.brand{font-family:'Orbitron',sans-serif;font-size:13px;font-weight:700;color:var(--cyan);letter-spacing:1px;}
.event{font-family:'Orbitron',sans-serif;font-size:13px;font-weight:700;color:var(--cyan);letter-spacing:1px;}
.remaining-draws{font-family:'Orbitron',sans-serif;font-size:13px;font-weight:700;color:var(--cyan);letter-spacing:1px;margin-top:4px;}
.remaining-number{display:inline-block;font-family:'Orbitron',sans-serif;font-weight:900;color:var(--gold);min-width:4ch;text-align:right;transition:all 0.3s ease;}
.remaining-number.updating{transform:scale(1.2);color:var(--magenta);}

/* Main layout */
.main-area{
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  gap:24px;width:100%;min-height:100vh;padding:70px 24px 50px;
  perspective:1200px;
  position:relative;
}
.reel-aura{
  position:absolute;
  width:min(90vw,1100px);height:240px;
  top:50%;left:50%;transform:translate(-50%,-60%);
  background:radial-gradient(ellipse,rgba(0,229,255,0.12) 0%,rgba(168,85,247,0.06) 40%,transparent 70%);
  filter:blur(50px);
  pointer-events:none;
  animation:auraBreath 5s ease-in-out infinite;
}
@keyframes auraBreath{0%,100%{opacity:0.6;transform:translate(-50%,-60%) scale(1);}50%{opacity:1;transform:translate(-50%,-60%) scale(1.08);}}

/* === Horizontal Reel === */
.reel-frame{
  position:relative;width:min(95vw,1200px);height:300px;flex-shrink:1;
  border:2px solid var(--border);border-radius:16px;
  background:rgba(13,13,26,0.85);overflow:hidden;
  box-shadow:
    0 0 40px rgba(0,229,255,0.08),
    0 20px 60px rgba(0,0,0,0.6),
    inset 0 0 30px rgba(0,0,0,0.5);
  backdrop-filter:blur(12px);
  transition:border-color 0.4s,box-shadow 0.4s;
  animation:reelFloat 6s ease-in-out infinite;
  transform-style:preserve-3d;
  z-index:20;
}
@keyframes reelFloat{
  0%,100%{transform:translateY(0) rotateX(0deg);}
  50%{transform:translateY(-8px) rotateX(0.5deg);}
}
.reel-frame.hot{border-color:var(--gold);box-shadow:0 0 50px rgba(255,217,61,0.2),0 20px 60px rgba(0,0,0,0.5),inset 0 0 30px rgba(0,0,0,0.5);}

/* === Hit Zone indicator === */
.hit-zone{
  position:absolute;left:50%;top:0;bottom:0;z-index:4;
  width:252px;transform:translateX(-50%);pointer-events:none;
}
/* Left & right glowing bracket lines */
.hit-zone::before,.hit-zone::after{
  content:'';position:absolute;top:0;bottom:0;width:3px;
  background:linear-gradient(to bottom,transparent 2%,var(--gold) 15%,var(--gold) 85%,transparent 98%);
  box-shadow:0 0 12px rgba(255,217,61,0.5),0 0 30px rgba(255,217,61,0.2);
  border-radius:2px;
}
.hit-zone::before{left:0;}
.hit-zone::after{right:0;}

/* Top & bottom triangle markers */
.hit-marker{
  position:absolute;left:50%;transform:translateX(-50%);z-index:5;
  display:flex;flex-direction:column;align-items:center;
}
.hit-marker.top{top:-2px;}
.hit-marker.bottom{bottom:-2px;}
.hit-marker .tri{
  width:0;height:0;
  border-left:14px solid transparent;border-right:14px solid transparent;
}
.hit-marker.top .tri{border-top:16px solid var(--gold);filter:drop-shadow(0 4px 8px rgba(255,217,61,0.5));}
.hit-marker.bottom .tri{border-bottom:16px solid var(--gold);filter:drop-shadow(0 -4px 8px rgba(255,217,61,0.5));}

/* Soft inner glow zone */
.hit-zone-glow{
  position:absolute;inset:0;
  background:linear-gradient(90deg,rgba(255,217,61,0.06),rgba(255,217,61,0.1),rgba(255,217,61,0.06));
  animation:hitGlow 2.5s ease-in-out infinite;
}
@keyframes hitGlow{0%,100%{opacity:0.5;}50%{opacity:1;}}

/* Hot state on stop (gold) */
.hit-zone.hot::before,.hit-zone.hot::after{
  background:linear-gradient(to bottom,transparent 2%,var(--gold) 15%,var(--gold) 85%,transparent 98%);
  box-shadow:0 0 20px rgba(255,217,61,0.8),0 0 50px rgba(255,217,61,0.3);
}
.hit-zone.hot .hit-zone-glow{
  background:linear-gradient(90deg,rgba(255,217,61,0.1),rgba(255,217,61,0.18),rgba(255,217,61,0.1));
}

/* Confirmed state (red - winner locked!) */
.reel-frame.confirmed{border-color:#FF2D48;box-shadow:0 0 60px rgba(255,45,72,0.25),0 20px 60px rgba(0,0,0,0.5),inset 0 0 30px rgba(0,0,0,0.5);transition:border-color 0.3s,box-shadow 0.3s;}
.hit-zone.confirmed::before,.hit-zone.confirmed::after{
  background:linear-gradient(to bottom,transparent 2%,#FF2D48 15%,#FF2D48 85%,transparent 98%);
  box-shadow:0 0 24px rgba(255,45,72,0.9),0 0 60px rgba(255,45,72,0.35);
  transition:all 0.3s;
}
.hit-zone.confirmed .hit-zone-glow{
  background:linear-gradient(90deg,rgba(255,45,72,0.1),rgba(255,45,72,0.2),rgba(255,45,72,0.1));
  animation:hitGlowRed 1.5s ease-in-out infinite;
}
.hit-zone.confirmed .hit-marker.top .tri{border-top-color:#FF2D48;filter:drop-shadow(0 4px 10px rgba(255,45,72,0.7));transition:all 0.3s;}
.hit-zone.confirmed .hit-marker.bottom .tri{border-bottom-color:#FF2D48;filter:drop-shadow(0 -4px 10px rgba(255,45,72,0.7));transition:all 0.3s;}
@keyframes hitGlowRed{0%,100%{opacity:0.6;}50%{opacity:1;}}

/* Reel navigation arrows (idle only) */
/* Reel wrapper (flexbox: ◀ [reel] ▶) */
.reel-wrapper{
  display:flex;align-items:center;gap:12px;
  position:relative;width:100%;justify-content:center;
}
.reel-nav{
  width:40px;height:60px;flex-shrink:0;
  display:flex;align-items:center;justify-content:center;
  background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.1);
  border-radius:10px;cursor:pointer;
  color:rgba(255,255,255,0.4);font-size:20px;
  transition:all 0.2s;user-select:none;
  opacity:0;pointer-events:none;
}
.reel-nav.show{opacity:1;pointer-events:auto;}
.reel-nav:hover{background:rgba(0,229,255,0.1);border-color:var(--cyan);color:var(--cyan);box-shadow:0 0 16px rgba(0,229,255,0.2);}
.reel-nav:active{transform:scale(0.92);background:rgba(0,229,255,0.18);}
@media(max-width:700px){
  .reel-wrapper{gap:6px;}
  .reel-nav{width:28px;height:48px;font-size:14px;}
}

.reel-strip{position:absolute;top:0;bottom:0;display:flex;flex-direction:row;align-items:center;transition:none;}
.reel-item{
  width:224px;height:252px;margin:0 16px;padding:12px 6px;
  display:flex;flex-direction:column;align-items:center;justify-content:space-between;
  background:linear-gradient(135deg,rgba(255,255,255,0.05),rgba(255,255,255,0.01));
  border:1px solid rgba(255,255,255,0.08);
  border-radius:14px;flex-shrink:0;
  box-shadow:0 4px 20px rgba(0,0,0,0.3),inset 0 1px 0 rgba(255,255,255,0.06);
  backdrop-filter:blur(4px);
}
.reel-item .item-no{font-family:'Orbitron',sans-serif;font-size:15px;font-weight:700;color:var(--cyan);letter-spacing:2px;opacity:0.7;flex-shrink:0;}
.reel-item .item-emoji{font-size:56px;flex-shrink:0;}
.reel-item .item-name{font-size:14px;color:var(--text-dim);font-weight:700;max-width:210px;text-align:center;line-height:1.3;display:-webkit-box;-webkit-line-clamp:4;-webkit-box-orient:vertical;overflow:hidden;word-break:break-word;flex-shrink:0;}
.reel-item .item-stock{font-family:'Orbitron',sans-serif;font-size:14px;font-weight:700;color:var(--gold);letter-spacing:1px;opacity:0.8;flex-shrink:0;}
.reel-item .item-rank{
  position:absolute;top:8px;right:8px;
  font-family:'Orbitron',sans-serif;font-size:11px;font-weight:900;
  padding:2px 5px;border-radius:4px;letter-spacing:0.5px;line-height:1.2;
}
.reel-item .item-rank.mega{background:linear-gradient(135deg,#ff2d78,#a855f7);color:#fff;box-shadow:0 0 8px rgba(255,45,120,0.5);}
.reel-item .item-rank.super{background:linear-gradient(135deg,#ffd93d,#ff8c00);color:#1a1a2e;box-shadow:0 0 8px rgba(255,217,61,0.5);}
.reel-item .item-rank.big{background:var(--cyan);color:#1a1a2e;box-shadow:0 0 8px rgba(0,229,255,0.4);}
.reel-item .item-rank.normal{background:rgba(255,255,255,0.12);color:var(--text-dim);font-size:9px;}
.reel-item{position:relative;}

.speed-lines{position:absolute;inset:0;pointer-events:none;opacity:0;transition:opacity 0.3s;overflow:hidden;z-index:3;}
.speed-line{position:absolute;top:0;bottom:0;width:1px;background:linear-gradient(to bottom,transparent,rgba(0,229,255,0.12),transparent);animation:speedLineH 0.25s linear infinite;}
@keyframes speedLineH{0%{transform:translateX(-30px);}100%{transform:translateX(30px);}}

.reel-fade-left,.reel-fade-right{position:absolute;top:0;bottom:0;width:100px;z-index:3;pointer-events:none;}
.reel-fade-left{left:0;background:linear-gradient(to right,rgba(10,10,28,0.95),transparent);}
.reel-fade-right{right:0;background:linear-gradient(to left,rgba(10,10,28,0.95),transparent);}

.reel-speed-display{
  display:none;  /* LOGウィンドウに移動したため非表示 */
  position:absolute;left:8px;bottom:8px;z-index:4;pointer-events:none;
  font-family:'Orbitron',sans-serif;font-size:10px;font-weight:500;
  color:var(--text-dim);opacity:0.7;letter-spacing:0.5px;
}
.reel-speed-display::before{content:'速度 ';opacity:0.8;}

/* === Control Area (below reel) === */
.control-area{
  display:flex;flex-direction:column;align-items:center;gap:10px;
  min-height:140px;justify-content:center;
}

/* Start / Stop button */
.big-btn{
  width:100px;height:100px;border-radius:50%;border:3px solid var(--cyan);
  background:radial-gradient(circle at 40% 35%,rgba(0,229,255,0.15),transparent 70%);
  color:var(--cyan);font-family:'Orbitron',sans-serif;font-size:15px;font-weight:900;
  cursor:pointer;display:flex;align-items:center;justify-content:center;
  transition:all 0.4s;letter-spacing:2px;box-shadow:0 0 30px rgba(0,229,255,0.15);
}
.big-btn:hover{box-shadow:0 0 50px rgba(0,229,255,0.3);transform:scale(1.05);}
.big-btn:active{transform:scale(0.95);}
.big-btn.stop{border-color:var(--magenta);color:var(--magenta);background:radial-gradient(circle at 40% 35%,rgba(255,45,120,0.15),transparent 70%);box-shadow:0 0 30px rgba(255,45,120,0.15);}
.big-btn.stop:disabled{border-color:var(--text-dim);color:var(--text-dim);background:rgba(0,0,0,0.3);box-shadow:none;cursor:not-allowed;opacity:0.6;pointer-events:none;}
.big-btn.stop:hover:not(:disabled){box-shadow:0 0 50px rgba(255,45,120,0.3);}
.big-btn.stopping{border-color:var(--gold);color:var(--gold);background:radial-gradient(circle at 40% 35%,rgba(255,217,61,0.15),transparent 70%);box-shadow:0 0 30px rgba(255,217,61,0.15);cursor:default;pointer-events:none;animation:btnPulse 0.8s ease-in-out infinite;font-size:12px;}
@keyframes btnPulse{0%,100%{box-shadow:0 0 30px rgba(255,217,61,0.15);}50%{box-shadow:0 0 50px rgba(255,217,61,0.35);}}
.btn-label{font-size:11px;color:var(--text-dim);letter-spacing:1px;font-family:'Orbitron',sans-serif;}

/* Spin control (START/STOP/演出中) */
.spin-control{display:flex;flex-direction:column;align-items:center;gap:10px;}

/* Winner showcase overlay (full screen, projector-optimized) */
.winner-overlay{
  position:fixed;inset:0;z-index:60;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  background:radial-gradient(ellipse at center,rgba(13,13,26,0.95) 0%,rgba(6,6,15,0.98) 100%);
  backdrop-filter:blur(30px);
  opacity:0;pointer-events:none;
  transition:opacity 0.5s ease;
}
.winner-overlay.show{opacity:1;pointer-events:auto;}

.winner-stage{
  display:flex;align-items:center;gap:min(6vw,64px);
  transform:scale(0.7);opacity:0;
  transition:transform 0.6s cubic-bezier(0.16,1,0.3,1), opacity 0.5s ease;
  max-width:90vw;width:100%;justify-content:center;
}
.winner-overlay.show .winner-stage{transform:scale(1);opacity:1;transition-delay:0.15s;}

.winner-visual{
  width:min(38vh,340px);height:min(38vh,340px);
  display:flex;align-items:center;justify-content:center;
  border-radius:32px;flex-shrink:0;
  background:rgba(255,217,61,0.05);border:2px solid rgba(255,217,61,0.2);
  box-shadow:0 0 100px rgba(255,217,61,0.1),0 0 200px rgba(0,229,255,0.05);
  animation:visualPulse 3s ease-in-out infinite;
}
.winner-visual .wv-emoji{font-size:min(18vh,160px);}
.winner-visual .wv-img{width:min(32vh,280px);height:min(32vh,280px);object-fit:cover;border-radius:24px;}
@keyframes visualPulse{0%,100%{box-shadow:0 0 100px rgba(255,217,61,0.1),0 0 200px rgba(0,229,255,0.05);}50%{box-shadow:0 0 140px rgba(255,217,61,0.2),0 0 260px rgba(0,229,255,0.1);}}

.winner-text-side{display:flex;flex-direction:column;gap:min(2vh,16px);align-items:flex-start;min-width:0;flex:1;max-width:min(55vw,600px);}

.winner-badge{
  font-family:'Orbitron',sans-serif;font-size:min(2.5vh,20px);font-weight:700;
  color:var(--cyan);letter-spacing:5px;
  padding:8px 24px;border:1px solid rgba(0,229,255,0.3);border-radius:24px;
  background:rgba(0,229,255,0.08);
}

.winner-rank-label{
  position:absolute;top:min(8vh,60px);left:50%;transform:translateX(-50%);
  font-family:'Orbitron',sans-serif;font-size:min(4vh,32px);font-weight:900;
  letter-spacing:8px;padding:12px 40px;border-radius:8px;
  opacity:0;transform:translateX(-50%) translateY(-20px);
  transition:opacity 0.4s ease, transform 0.4s ease;
}
.winner-overlay.show .winner-rank-label{opacity:1;transform:translateX(-50%) translateY(0);transition-delay:0.3s;}
.winner-rank-label.mega{
  background:linear-gradient(135deg,#ff2d78,#a855f7);color:#fff;
  box-shadow:0 0 60px rgba(255,45,120,0.5),0 0 120px rgba(168,85,247,0.3);
  animation:megaPulse 1s ease-in-out infinite;
}
.winner-rank-label.super{
  background:linear-gradient(135deg,#ffd93d,#ff8c00);color:#1a1a2e;
  box-shadow:0 0 50px rgba(255,217,61,0.4);
}
.winner-rank-label.big{
  background:var(--cyan);color:#1a1a2e;
  box-shadow:0 0 40px rgba(0,229,255,0.3);
}
.winner-rank-label.normal{display:none;}
@keyframes megaPulse{0%,100%{box-shadow:0 0 60px rgba(255,45,120,0.5),0 0 120px rgba(168,85,247,0.3);}50%{box-shadow:0 0 100px rgba(255,45,120,0.7),0 0 180px rgba(168,85,247,0.5);}}

.winner-name-area{display:flex;flex-direction:column;gap:min(1.5vh,10px);max-width:100%;}
.winner-name-area .wn-name{font-size:min(7vh,56px);font-weight:700;color:var(--gold);letter-spacing:2px;line-height:1.2;word-break:break-word;overflow-wrap:break-word;}
.winner-name-area .wn-congrats{font-size:min(2.8vh,22px);color:var(--text-dim);letter-spacing:2px;}

.winner-ring{
  position:absolute;width:min(55vh,480px);height:min(55vh,480px);border-radius:50%;
  border:1px solid rgba(255,217,61,0.1);
  animation:ringRotate 12s linear infinite;pointer-events:none;
}
.winner-ring:nth-child(2){width:min(65vh,560px);height:min(65vh,560px);border-color:rgba(0,229,255,0.06);animation-duration:18s;animation-direction:reverse;}
@keyframes ringRotate{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}

.next-btn{
  margin-top:min(3vh,24px);
  padding:16px 52px;border-radius:14px;border:2px solid var(--gold);
  background:rgba(255,217,61,0.08);color:var(--gold);
  font-family:'Zen Maru Gothic',sans-serif;font-size:min(2.5vh,20px);font-weight:700;
  cursor:pointer;transition:all 0.3s;letter-spacing:2px;
  opacity:0;transform:translateY(10px);
  line-height:1.4;
}
.winner-overlay.show .next-btn{opacity:1;transform:translateY(0);transition-delay:0.8s;}
/* サクサクモード: 当選オーバーレイの表示テンポを短縮 */
.fast-mode .winner-overlay.show .winner-stage{transition-delay:0.05s;}
.fast-mode .winner-overlay.show .winner-rank-label{transition-delay:0.1s;}
.fast-mode .winner-overlay.show .next-btn{transition-delay:0.3s;}
.next-btn:hover{background:rgba(255,217,61,0.15);box-shadow:0 0 30px rgba(255,217,61,0.15);transform:scale(1.03);}
.next-btn:active{transform:scale(0.97);}


/* Flash */
/* Image zoom overlay (tap reel image to enlarge) */
.image-zoom-overlay{
  position:fixed;inset:0;z-index:90;
  background:rgba(0,0,0,0.85);backdrop-filter:blur(12px);
  display:flex;align-items:center;justify-content:center;
  opacity:0;pointer-events:none;transition:opacity 0.25s ease;
}
.image-zoom-overlay.show{opacity:1;pointer-events:auto;cursor:pointer;}
.image-zoom-content{
  max-width:90vw;max-height:85vh;display:flex;flex-direction:column;align-items:center;gap:16px;
  cursor:default;pointer-events:auto;
}
.image-zoom-content img{
  max-width:min(80vw,500px);max-height:min(70vh,450px);
  object-fit:contain;border-radius:16px;
  box-shadow:0 0 60px rgba(0,229,255,0.15),0 20px 80px rgba(0,0,0,0.6);
  border:2px solid rgba(255,255,255,0.1);
}
.image-zoom-name{font-size:18px;font-weight:700;color:var(--gold);text-align:center;padding:0 24px;}
.image-zoom-close{
  padding:12px 24px;border-radius:10px;border:2px solid var(--cyan);
  background:rgba(0,229,255,0.1);color:var(--cyan);
  font-family:'Zen Maru Gothic',sans-serif;font-size:14px;font-weight:700;
  cursor:pointer;transition:all 0.2s;
}
.image-zoom-close:hover{background:rgba(0,229,255,0.2);box-shadow:0 0 20px rgba(0,229,255,0.2);}
.reel-item .reel-item-img-wrap{cursor:pointer;display:flex;align-items:center;justify-content:center;flex:1;min-height:0;line-height:0;}
.reel-item .reel-item-img-wrap img{transition:opacity 0.2s;width:130px;height:130px;object-fit:cover;border-radius:12px;}
.reel-item .reel-item-img-wrap:hover img{opacity:0.9;}
.reel-item .reel-item-img-wrap:active img{opacity:0.8;}
.reel-item-btns{
  position:absolute;top:6px;left:6px;z-index:2;
  display:flex;flex-direction:column;gap:4px;
}
.reel-item .reel-item-pin{
  width:28px;height:28px;border-radius:6px;border:1px solid var(--border);
  background:rgba(0,0,0,0.4);color:var(--text);cursor:pointer;
  display:flex;align-items:center;justify-content:center;font-size:14px;
  transition:all 0.2s;flex-shrink:0;
}
.reel-item .reel-item-pin:hover{border-color:var(--cyan);color:var(--cyan);background:rgba(0,229,255,0.15);}
.reel-item .reel-item-pin.pin-defaulted{border-color:#ef4444;color:#ef4444;background:rgba(239,68,68,0.15);}
.reel-item .reel-item-pin.pin-defaulted:hover{border-color:#f87171;color:#f87171;background:rgba(248,113,113,0.25);}

.flash-overlay{position:fixed;inset:0;background:#fff;opacity:0;pointer-events:none;z-index:100;transition:opacity 0.1s;}
.flash-overlay.show{opacity:0.7;transition:opacity 0.05s;}

/* Confetti & Sparkles (over everything, but pointer-events:none) */
.confetti-container{position:fixed;inset:0;pointer-events:none;z-index:55;overflow:hidden;}
.confetti{position:absolute;top:-20px;animation:confettiFall linear forwards;}
@keyframes confettiFall{0%{transform:translateY(0) rotate(0deg);opacity:1;}100%{transform:translateY(100vh) rotate(720deg);opacity:0;}}
.sparkle-container{position:fixed;inset:0;pointer-events:none;z-index:56;overflow:hidden;}
.sparkle{position:absolute;background:#fff;border-radius:50%;animation:sparkleAnim ease-in-out infinite;}
.petals-container{position:fixed;inset:0;pointer-events:none;z-index:65;overflow:hidden;}
.petal{
  position:absolute;border-radius:50% 0 50% 0;
  animation:petalFall linear forwards;
  transform-origin:center;
}
@keyframes petalFall{
  0%{
    transform:translateY(0) rotate(0deg);
    opacity:0.9;
  }
  25%{
    transform:translateY(25vh) rotate(180deg) translateX(var(--swing, 0px));
  }
  50%{
    transform:translateY(50vh) rotate(360deg) translateX(calc(var(--swing, 0px) * -1));
  }
  75%{
    transform:translateY(75vh) rotate(540deg) translateX(var(--swing, 0px));
  }
  100%{
    transform:translateY(110vh) rotate(720deg) translateX(calc(var(--swing, 0px) * -1));
    opacity:0;
  }
}
@keyframes sparkleAnim{0%,100%{opacity:0;transform:scale(0);}50%{opacity:1;transform:scale(1);}}

/* Settings */
.settings-overlay{position:fixed;top:0;right:0;bottom:0;width:420px;z-index:80;background:rgba(13,13,26,0.98);backdrop-filter:blur(20px);border-left:1px solid var(--border);transform:translateX(100%);pointer-events:none;transition:transform 0.3s;overflow-y:auto;}
.settings-overlay.show{transform:translateX(0);pointer-events:auto;}
.settings-card{width:100%;max-width:none;max-height:none;background:transparent;border:none;border-radius:0;padding:20px;overflow-y:visible;}
.settings-title{font-family:'Orbitron',sans-serif;font-size:14px;font-weight:700;color:var(--cyan);letter-spacing:2px;margin-bottom:20px;}
.setting-group{margin-bottom:18px;}
.setting-label{font-size:12px;color:var(--text-dim);margin-bottom:6px;letter-spacing:0.5px;}
.setting-input{width:100%;padding:10px 14px;background:rgba(255,255,255,0.04);border:1px solid var(--border);border-radius:8px;color:var(--text);font-size:14px;font-family:'Zen Maru Gothic',sans-serif;transition:border-color 0.3s;}
.setting-input:focus{outline:none;border-color:var(--cyan);}
.settings-actions{display:flex;gap:12px;margin-top:24px;}
.s-btn{flex:1;padding:10px;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer;border:1px solid var(--border);font-family:'Zen Maru Gothic',sans-serif;transition:all 0.3s;}
.s-btn.save{background:var(--cyan);color:var(--bg);border-color:var(--cyan);}
.s-btn.save:hover{background:#33EBFF;}
.s-btn.cancel{background:transparent;color:var(--text-dim);}
.s-btn.cancel:hover{border-color:var(--text-dim);}

/* Settings tabs */
.settings-tabs{display:flex;gap:4px;margin-bottom:20px;border-bottom:1px solid var(--border);padding-bottom:12px;}
.stab{padding:8px 16px;border:1px solid var(--border);border-radius:8px;background:transparent;color:var(--text-dim);font-size:12px;font-weight:700;cursor:pointer;transition:all 0.2s;font-family:'Zen Maru Gothic',sans-serif;}
.stab:hover{border-color:var(--cyan);color:var(--cyan);}
.stab.active{border-color:var(--cyan);color:var(--cyan);background:rgba(0,229,255,0.1);}

/* Sound debug grid */
.sound-grid{display:flex;flex-direction:column;gap:6px;}
.sound-row{display:flex;align-items:center;gap:8px;padding:8px 10px;background:rgba(255,255,255,0.02);border:1px solid var(--border);border-radius:8px;}
.sound-row .sr-name{flex:1;font-size:12px;color:var(--text);font-weight:500;}
.sound-row .sr-desc{flex:2;font-size:10px;color:var(--text-dim);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.sound-row .sr-toggle{width:40px;height:22px;border-radius:11px;border:none;cursor:pointer;position:relative;transition:background 0.2s;}
.sound-row .sr-toggle.on{background:var(--cyan);}
.sound-row .sr-toggle.off{background:var(--border);}
.sound-row .sr-toggle::after{content:'';position:absolute;top:3px;left:3px;width:16px;height:16px;border-radius:50%;background:#fff;transition:transform 0.2s;}
.sound-row .sr-toggle.on::after{transform:translateX(18px);}
.sound-row .sr-play{width:28px;height:28px;border-radius:6px;border:1px solid var(--border);background:transparent;color:var(--text-dim);cursor:pointer;font-size:12px;transition:all 0.2s;}
.sound-row .sr-play:hover{border-color:var(--gold);color:var(--gold);}
.sound-row .sr-upload-btn{display:inline-flex;align-items:center;justify-content:center;width:28px;height:28px;border-radius:6px;border:1px solid var(--border);background:transparent;color:var(--text-dim);cursor:pointer;font-size:14px;transition:all 0.2s;}
.sound-row .sr-upload-btn:hover{border-color:var(--cyan);color:var(--cyan);}

/* BGM Volume slider */
.volume-slider{width:100%;max-width:200px;height:8px;margin-right:10px;-webkit-appearance:none;appearance:none;background:var(--border);border-radius:4px;outline:none;}
.volume-slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:18px;height:18px;border-radius:50%;background:var(--gold);cursor:pointer;box-shadow:0 0 8px rgba(255,217,61,0.5);}
.volume-slider::-moz-range-thumb{width:18px;height:18px;border-radius:50%;background:var(--gold);cursor:pointer;border:none;box-shadow:0 0 8px rgba(255,217,61,0.5);}
.volume-row{display:flex;align-items:center;flex-wrap:wrap;gap:8px;margin-bottom:12px;}
.volume-label{font-size:12px;color:var(--text-dim);min-width:36px;}

/* Prize list grid */
.prize-desc{font-size:11px;color:var(--text-dim);margin:0 0 12px;line-height:1.5;}
.prize-action-row{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-bottom:8px;}
.sheet-status{font-size:11px;margin-top:6px;min-height:1.2em;}
.prize-summary{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-bottom:12px;padding:10px 12px;background:rgba(255,255,255,0.03);border-radius:8px;border:1px solid var(--border);}
.prize-summary .ps-total{font-size:14px;font-weight:700;color:var(--cyan);}
.prize-summary .ps-badge{padding:4px 8px;border-radius:6px;font-size:11px;font-weight:700;}
.prize-summary .ps-badge.mega{background:linear-gradient(135deg,#ff2d78,#a855f7);color:#fff;}
.prize-summary .ps-badge.super{background:linear-gradient(135deg,#ffd93d,#ff8c00);color:#1a1a2e;}
.prize-summary .ps-badge.big{background:var(--cyan);color:#1a1a2e;}
.prize-summary .ps-badge.normal{background:var(--border);color:var(--text);}
.prize-rank-legend{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:12px;max-width:100%;}
.rank-badge{padding:4px 6px;border-radius:6px;font-size:9px;font-weight:700;flex-shrink:0;}
.rank-badge.mega{background:linear-gradient(135deg,#ff2d78,#a855f7);color:#fff;}
.rank-badge.super{background:linear-gradient(135deg,#ffd93d,#ff8c00);color:#1a1a2e;}
.rank-badge.big{background:var(--cyan);color:#1a1a2e;}
.rank-badge.normal{background:var(--border);color:var(--text);}
.prize-bulk-actions{display:flex;gap:6px;margin-bottom:12px;}
.prize-list-scroll{max-height:55vh;overflow-y:auto;overflow-x:auto;border:1px solid var(--border);border-radius:8px;padding:8px;}
.prize-grid{display:flex;flex-direction:column;gap:6px;}
.prize-card{display:flex;flex-direction:column;gap:6px;background:rgba(255,255,255,0.02);border:2px solid var(--border);border-radius:10px;padding:8px;transition:all 0.2s;}
.prize-card.mega{border-color:#ff2d78;background:rgba(255,45,120,0.08);}
.prize-card.super{border-color:#ffd93d;background:rgba(255,217,61,0.08);}
.prize-card.big{border-color:var(--cyan);background:rgba(0,229,255,0.08);}
.prize-card .pc-top{display:flex;align-items:center;gap:8px;flex-wrap:wrap;min-width:0;}
.prize-card .pc-img-wrap{flex-shrink:0;width:44px;height:44px;border-radius:8px;background:var(--border);overflow:hidden;display:flex;align-items:center;justify-content:center;}
.prize-card .pc-img-wrap>img,.prize-card .pc-img-wrap>.pc-emoji{width:100%;height:100%;object-fit:cover;border-radius:8px;}
.prize-card .pc-img{width:100%;height:100%;object-fit:cover;border-radius:8px;}
.prize-card .pc-emoji{font-size:22px;width:100%;height:100%;display:flex;align-items:center;justify-content:center;}
.prize-card .pc-img-btns{display:flex;gap:4px;flex-shrink:0;}
.prize-card .pc-ib{width:28px;height:28px;border-radius:6px;border:1px solid var(--border);background:rgba(0,0,0,0.4);color:var(--text);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:all 0.2s;flex-shrink:0;}
.prize-card .pc-ib:hover{border-color:var(--cyan);color:var(--cyan);background:rgba(0,229,255,0.15);}
.prize-card .pc-upload-btn{flex-shrink:0;width:28px;height:28px;border-radius:6px;border:1px solid var(--border);background:rgba(0,0,0,0.3);color:var(--text-dim);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:all 0.2s;}
.prize-card .pc-upload-btn:hover{border-color:var(--cyan);color:var(--cyan);}
.prize-card .pc-no{font-size:11px;font-weight:700;color:var(--cyan);white-space:nowrap;flex-shrink:0;}
.prize-card .pc-stock{display:flex;align-items:center;gap:3px;flex-shrink:0;margin-left:auto;}
.prize-card .pc-stock-label{font-size:9px;color:var(--text-dim);white-space:nowrap;}
.prize-card .pc-stock-input{width:36px;padding:3px 2px;border:1px solid var(--border);border-radius:4px;background:rgba(0,0,0,0.3);color:var(--gold);font-size:11px;font-weight:700;font-family:'Orbitron',sans-serif;text-align:center;}
.prize-card .pc-stock-input:focus{border-color:var(--gold);outline:none;}
.prize-card .pc-rank{display:flex;gap:3px;flex-shrink:0;}
.prize-card .pr-btn{width:26px;height:24px;border:1px solid var(--border);border-radius:4px;background:transparent;color:var(--text-dim);font-size:9px;font-weight:700;cursor:pointer;transition:all 0.15s;}
.prize-card .pr-btn:hover{border-color:var(--text);}
.prize-card .pr-btn.active.mega{background:linear-gradient(135deg,#ff2d78,#a855f7);border-color:#ff2d78;color:#fff;}
.prize-card .pr-btn.active.super{background:linear-gradient(135deg,#ffd93d,#ff8c00);border-color:#ffd93d;color:#1a1a2e;}
.prize-card .pr-btn.active.big{background:var(--cyan);border-color:var(--cyan);color:#1a1a2e;}
.prize-card .pr-btn.active.normal{background:var(--text-dim);border-color:var(--text-dim);color:#1a1a2e;}
.prize-card .pc-name-input{width:100%;min-width:0;padding:5px 8px;border:1px solid var(--border);border-radius:4px;background:rgba(0,0,0,0.3);color:var(--text);font-size:12px;font-family:inherit;box-sizing:border-box;line-height:1.4;word-break:break-word;}
.prize-card .pc-name-input:focus{border-color:var(--cyan);outline:none;}
.prize-card .pc-name-input::placeholder{color:var(--text-dim);opacity:0.6;}

/* Header toolbar (flat design) */
.header-right{display:flex;align-items:stretch;gap:2px;height:30px;}
.tb-btn{
  height:30px !important;min-height:30px !important;max-height:30px !important;
  padding:0 10px !important;border:none !important;margin:0 !important;
  background:rgba(255,255,255,0.06);color:var(--text-dim);cursor:pointer;
  display:flex !important;align-items:center !important;justify-content:center !important;gap:5px;
  font-size:11px;font-family:'Orbitron',sans-serif;font-weight:600;letter-spacing:0.5px;
  transition:background 0.2s, color 0.2s !important;white-space:nowrap;box-sizing:border-box !important;
  overflow:hidden;vertical-align:top;flex-shrink:0;
}
.tb-btn:first-child{border-radius:6px 0 0 6px;}
.tb-btn:last-child{border-radius:0 6px 6px 0;}
.tb-btn:hover{background:rgba(255,255,255,0.12);color:var(--text);}
.tb-btn.on{
  background:rgba(0,229,255,0.12) !important;color:var(--cyan) !important;
  height:30px !important;min-height:30px !important;max-height:30px !important;
  padding:0 10px !important;border:none !important;margin:0 !important;
}
.tb-btn .tb-icon{
  font-size:13px !important;line-height:1 !important;
  display:flex !important;align-items:center !important;justify-content:center !important;
  height:auto !important;flex-shrink:0;margin:0 !important;padding:0 !important;
}
.tb-btn .tb-label{
  font-size:9px !important;opacity:0.8;display:inline-block !important;
  line-height:1em !important;height:1em !important;
  min-height:1em !important;max-height:1em !important;
  overflow:hidden;vertical-align:middle;margin:0 !important;padding:0 !important;
  box-sizing:border-box !important;
}

/* Console panel (beside start button, absolutely positioned) */
.control-row{
  position:relative;
  display:flex;align-items:center;justify-content:center;width:100%;
}
.reel-item-upload{
  width:26px;height:26px;border-radius:6px;border:1px solid var(--border);
  background:rgba(0,0,0,0.6);color:var(--text-dim);cursor:pointer;
  font-size:12px;display:flex;align-items:center;justify-content:center;
  transition:all 0.2s;padding:0;
}
.reel-item-upload:hover{border-color:var(--cyan);color:var(--cyan);background:rgba(0,229,255,0.2);}
.reel-item-upload.pin-defaulted,.pc-ib.pin-defaulted{border-color:#ef4444;color:#ef4444;background:rgba(239,68,68,0.15);}
.reel-item-upload.pin-defaulted:hover,.pc-ib.pin-defaulted:hover{border-color:#f87171;color:#f87171;background:rgba(248,113,113,0.25);}
.console-panel{
  position:absolute;left:calc(50% - min(47.5vw, 600px));top:0;
  width:calc(min(47.5vw, 600px) - 80px);height:300px;
  background:rgba(13,13,26,0.85);border:1px solid var(--border);border-radius:10px;
  backdrop-filter:blur(8px);
  display:none;overflow:hidden;flex-direction:column;
  font-family:'Orbitron',sans-serif;font-size:11px;
}
.console-panel.show{display:flex;}
.console-header{
  display:flex;align-items:center;
  flex-shrink:0;padding:6px 10px;font-size:10px;color:var(--text-dim);
  background:rgba(168,85,247,0.15);border-bottom:1px solid var(--border);
  line-height:1.35;letter-spacing:0.3px;
}
.console-header > span:first-child{
  margin-right:16px;  /* LOGの右側にスペース */
}
.console-header kbd{font-family:inherit;padding:1px 4px;border-radius:4px;background:rgba(0,0,0,0.3);font-size:10px;}
.console-header code{font-size:9px;color:var(--cyan);}
.console-speed{
  font-family:'Orbitron',sans-serif;font-size:10px;font-weight:700;
  color:var(--cyan);opacity:1;letter-spacing:0.5px;
  min-width:60px;text-align:left;  /* 固定幅で左寄せ */
}
.console-header .app-version{
  font-size:10px;color:var(--text-dim);opacity:0.85;
  font-family:'Orbitron',sans-serif;letter-spacing:0.5px;white-space:nowrap;
  margin-left:8px;margin-right:8px;
}
.console-clear-btn{
  margin-left:auto;  /* 右側に配置 */
  padding:2px 6px;border:none;border-radius:4px;
  background:rgba(0,0,0,0.3);color:var(--text-dim);
  font-size:12px;cursor:pointer;transition:all 0.2s;
  line-height:1;opacity:0.7;
}
.console-clear-btn:hover{
  background:rgba(239,68,68,0.2);color:#ef4444;opacity:1;
}
.console-inner{
  flex:1;min-height:0;width:100%;
  overflow-y:scroll;overflow-x:auto;
  padding:8px 10px 8px 10px;
}
.console-inner::-webkit-scrollbar{width:8px;}
.console-inner::-webkit-scrollbar-track{background:rgba(168,85,247,0.12);border-radius:0 10px 10px 0;}
.console-inner::-webkit-scrollbar-thumb{background:var(--purple);border-radius:4px;}
.console-inner::-webkit-scrollbar-thumb:hover{background:#c084fc;}
.console-inner{scrollbar-width:thin;scrollbar-color:var(--purple) rgba(168,85,247,0.12);}
.console-line{
  color:var(--text-dim);line-height:1.4;letter-spacing:0.5px;
  padding:2px 0;border-bottom:1px solid rgba(255,255,255,0.03);
  word-break:break-word;overflow-wrap:break-word;min-width:0;
}
.console-line .cl-time{color:var(--purple);margin-right:6px;}
.console-line .cl-msg{color:var(--text-dim);}
.console-line.highlight .cl-msg{color:var(--gold);}

/* Speed mode toggle buttons */
.speed-opt{
  flex:1;padding:10px 12px;border-radius:8px;border:1px solid var(--border);
  background:rgba(255,255,255,0.03);color:var(--text-dim);
  font-family:'Zen Maru Gothic',sans-serif;font-size:13px;font-weight:700;
  cursor:pointer;transition:all 0.3s;text-align:center;
}
.speed-opt:hover{border-color:var(--cyan);color:var(--text);}
.speed-opt.active{border-color:var(--cyan);color:var(--cyan);background:rgba(0,229,255,0.08);}
.sheet-link{
  display:inline-flex;align-items:center;gap:6px;padding:10px 16px;
  background:rgba(0,229,255,0.1);border:1px solid var(--cyan);
  border-radius:8px;color:var(--cyan);text-decoration:none;font-weight:700;
  transition:all 0.2s;font-size:14px;
}
.sheet-link:hover{background:rgba(0,229,255,0.2);}

/* History panel (slide-out from left) */
.history-panel{
  position:fixed;top:0;left:0;bottom:0;width:340px;z-index:80;
  background:rgba(13,13,26,0.98);backdrop-filter:blur(20px);
  border-right:1px solid var(--border);
  transform:translateX(-100%);pointer-events:none;
  transition:transform 0.3s;overflow-y:auto;
}
.history-panel.show{transform:translateX(0);pointer-events:auto;}
.history-panel::-webkit-scrollbar{width:6px;}
.history-panel::-webkit-scrollbar-track{background:rgba(0,229,255,0.05);}
.history-panel::-webkit-scrollbar-thumb{background:rgba(0,229,255,0.3);border-radius:4px;}
.history-panel::-webkit-scrollbar-thumb:hover{background:var(--cyan);}
.history-panel{scrollbar-width:thin;scrollbar-color:rgba(0,229,255,0.3) rgba(0,229,255,0.05);}
.history-panel-inner{padding:20px 16px 80px;}
.history-header{
  display:flex;align-items:center;justify-content:space-between;
  margin-bottom:16px;padding-bottom:12px;
  border-bottom:1px solid var(--border);
}
.history-title{
  font-family:'Orbitron',sans-serif;font-size:13px;font-weight:700;
  color:var(--cyan);letter-spacing:2px;
}
.history-header-right{
  display:flex;align-items:center;gap:10px;
}
.history-count{font-size:12px;color:var(--text-dim);font-family:'Orbitron',sans-serif;}
.history-clear-btn{
  padding:4px 10px;font-size:11px;border-radius:6px;
  background:rgba(251,146,60,0.15);border:1px solid #FB923C;color:#FB923C;
  cursor:pointer;transition:all 0.2s;font-family:'Zen Maru Gothic',sans-serif;
}
.history-clear-btn:hover{background:rgba(251,146,60,0.3);}
.history-empty{
  text-align:center;padding:32px;color:var(--text-dim);font-size:14px;
  border:1px dashed var(--border);border-radius:12px;
}
.history-list{display:flex;flex-direction:column;gap:6px;}
.history-item{
  display:flex;align-items:center;gap:12px;
  padding:10px 12px;border-radius:10px;
  background:rgba(255,255,255,0.03);border:1px solid var(--border);
  animation:histFadeIn 0.4s ease-out;
}
@keyframes histFadeIn{from{opacity:0;transform:translateX(-8px);}to{opacity:1;transform:translateX(0);}}
.history-item .h-order{
  font-family:'Orbitron',sans-serif;font-size:10px;font-weight:700;
  color:var(--text-dim);min-width:28px;letter-spacing:1px;
}
.history-item .h-rank-badge{
  display:inline-flex;align-items:center;justify-content:center;
  min-width:28px;padding:2px 6px;border-radius:4px;font-size:10px;font-weight:800;
  font-family:'Orbitron',sans-serif;letter-spacing:0.5px;flex-shrink:0;
}
.history-item .h-rank-badge.h-rank-mega{background:#FF2D78;color:#fff;}
.history-item .h-rank-badge.h-rank-super{background:#FFD93D;color:#1a1a2e;}
.history-item .h-rank-badge.h-rank-big{background:#00E5FF;color:#1a1a2e;}
.history-item .h-rank-badge.h-rank-normal{background:rgba(255,255,255,0.15);color:rgba(255,255,255,0.7);}
.history-item .h-emoji{font-size:24px;flex-shrink:0;}
.history-item .h-info{flex:1;display:flex;flex-direction:column;gap:2px;min-width:0;}
.history-item .h-name{font-size:13px;font-weight:700;color:var(--text);line-height:1.4;word-break:break-word;}
.history-item .h-no{font-family:'Orbitron',sans-serif;font-size:10px;color:var(--cyan);letter-spacing:1px;}
.history-item .h-img{width:32px;height:32px;object-fit:cover;border-radius:6px;flex-shrink:0;}
.history-item-del{
  flex-shrink:0;width:24px;height:24px;padding:0;
  border-radius:50%;border:1px solid rgba(255,255,255,0.2);
  background:rgba(255,255,255,0.05);color:var(--text-dim);
  font-size:14px;line-height:1;cursor:pointer;transition:all 0.2s;
  display:flex;align-items:center;justify-content:center;
}
.history-item-del:hover{background:rgba(255,80,80,0.3);border-color:#ff5050;color:#fff;}
/* History badge on toolbar */
.tb-badge{
  display:inline-flex;align-items:center;justify-content:center;
  min-width:16px;height:16px;padding:0 4px;border-radius:8px;
  background:var(--cyan);color:var(--bg);font-size:9px;font-weight:900;
  font-family:'Orbitron',sans-serif;margin-left:4px;
}

.footer{position:relative;bottom:0;left:0;right:0;padding:10px 24px;text-align:center;font-size:10px;color:var(--text-dim);letter-spacing:1px;font-family:'Orbitron',sans-serif;}

</style>
