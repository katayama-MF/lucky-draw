# 本番利用の進め方：GitHub共有 vs クラウド＋2台同期

---

## 1. GitHub ＋ ローカルで起動（スタッフ共有）

**そのままで問題なく使えます。** リポジトリを共有し、各自のPCで起動する方式です。

### 手順（スタッフ向け）

1. **リポジトリをクローン**
   ```bash
   git clone https://github.com/<組織またはあなた>/lucky-draw.git
   cd lucky-draw
   ```

2. **起動**
   ```bash
   npm install   # 初回のみ（スクリプト用。必須ではない）
   npm run dev   # または npm start
   ```
   - 表示された **http://localhost:3000** をブラウザで開く
   - ポートを変えたい場合: `npx serve . -l 8080` など

3. **利用**
   - 賞品はスプレッドシートで管理（設定画面の「賞品 一覧」→ スプシを開く／更新）
   - 設定・抽選履歴・残り回数は **そのPCのブラウザの localStorage** に保存される

### 注意点（ローカル運用）

- **端末ごとに設定・履歴は別**  
  AさんのPCとBさんのPCでは、設定・抽選履歴・残り回数は共有されません。  
  「1台のPCで本番運用」「または各自が自分の環境で試す」想定です。
- 賞品マスタは **スプレッドシート** で共有しているので、スプシを共通にすれば賞品リストは全員同じにできます。

---

## 2. クラウドにデプロイする（URL共有で利用）

静的サイトとしてデプロイすれば、**URLを共有するだけで**どこからでもアクセスできます。  
**Vercel / Netlify / GitHub Pages / Cloudflare Pages** などが使えます。

### 例：Vercel でデプロイ

1. [vercel.com](https://vercel.com) でアカウント作成
2. GitHub の lucky-draw リポジトリをインポート
3. ビルドコマンドは **不要**（静的ファイルのみ）
4. デプロイ → 発行された URL（例: `https://lucky-draw-xxx.vercel.app`）をスタッフに共有

### 例：Netlify

1. [netlify.com](https://netlify.com) で GitHub リポジトリを接続
2. ビルドコマンド: 空でOK
3. 公開ディレクトリ: `.`（ルート）
4. デプロイ → URL を共有

### この時点での「2台の端末」の動き

- **同じURLを2台の端末で開く** → どちらも「同じアプリ」が動く
- **設定・抽選履歴・残り回数** は **ブラウザごと（端末ごと）** に保存される（localStorage / IndexedDB）
- つまり **「2台で同期」はまだしていない** ＝ 端末Aで抽選しても、端末Bの履歴・残り回数は変わりません

---

## 3. 完全にクラウド化して「2台で同期」するには

**「2台の端末で同じ残り回数・同じ履歴・同じ設定で進めたい」** 場合は、**サーバー側（または BaaS）にデータを置く**必要があります。

### 必要なこと（概要）

| 現在 | 同期を実現するには |
|------|---------------------|
| 設定 → localStorage | 設定をサーバー or Firebase 等に保存し、2台ともそこを読む |
| 抽選履歴・残り回数 → localStorage | 同上。抽選するたびにサーバーに書き、他端末は読み直す or リアルタイム購読 |
| 画像キャッシュ → IndexedDB | オプション。URL管理ならスプシのままでも可 |

### 実装の選択肢

- **A. Firebase（Firestore + Storage）**
  - 設定・履歴・残り回数を Firestore のドキュメントに保存
  - 2台とも同じドキュメントを参照し、更新時にリアルタイムで反映
  - 画像は Storage に上げるか、従来どおりスプシのURLのままでも可
- **B. Supabase（PostgreSQL + Realtime）**
  - 設定・履歴用のテーブルを作り、API で読み書き。Realtime で購読すれば2台同期
- **C. 自前の軽量API（例: Node + SQLite や JSON ファイル）**
  - デプロイ先（Vercel Serverless / さくら等）で「設定・履歴の読み書きAPI」を用意し、フロントから localStorage の代わりにそのAPIを呼ぶ

いずれも **lucky-draw の script.js の「保存・読み込み」部分を、localStorage ではなく API または Firebase に差し替える** 改修が必要です。

### 工数目安のイメージ

- **静的デプロイのみ（2台同期なし）**: ドキュメントとデプロイ設定だけで済む（上記 2 の範囲）
- **2台同期まで含める**:  
  - Firebase/Supabase を入れて、設定・履歴の保存先を差し替える実装で **おおむね 1〜3 日** 程度（既存の保存/読込箇所の把握と置き換え、テストの含み）

---

## まとめ

| やり方 | 共有の仕方 | 2台で同期？ |
|--------|------------|-------------|
| **GitHub ＋ ローカル** | リポジトリをクローンして `npm run dev` | しない（各PCで独立） |
| **クラウド（静的のみ）** | デプロイしたURLを共有 | しない（各ブラウザで独立） |
| **クラウド ＋ バックエンド** | 同上 ＋ 設定・履歴をサーバー/BaaS に保存 | **する**（要開発） |

- **「スタッフとコード共有して、各自 or 1台のPCで本番運用」** → GitHub ＋ ローカルで十分です。
- **「同じURLを2台で開いて、残り回数・履歴をそろえたい」** → クラウドに上げつつ、Firebase や Supabase などで「設定・履歴の同期」を追加する形になります。

必要なら「Firebase で同期する場合の具体的な改修案」も別ドキュメントで整理できます。
