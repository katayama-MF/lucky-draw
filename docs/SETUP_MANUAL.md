# LUCKY DRAW 導入マニュアル（ローカル版）

**読む方へ**  
このマニュアルは、プログラミングの経験がなくても LUCKY DRAW（抽選アプリ）をパソコンで動かし、賞品リストや画像を設定できるように書いています。  
手順どおりに進めれば、最後には抽選画面が表示され、START と STOP で景品が決まる状態になります。

---

## このマニュアルで出てくる言葉

| 言葉 | 意味（ここでは） |
|------|------------------|
| **ブラウザ** | インターネットを見るソフト。Chrome（クローム）・Edge（エッジ）・Safari（サファリ）など。 |
| **ターミナル（Windowsでは「コマンドプロンプト」）** | 文字だけの画面で、決まった言葉（コマンド）を入力してパソコンに指示を出す場所。黒い画面に白い文字で表示されます。 |
| **ローカル / ローカルで起動** | 自分のパソコンの中だけで動かす、という意味です。インターネット上のサーバーには置きません。 |
| **スプシ** | Google スプレッドシートのこと。賞品の一覧をスプシで管理します。 |
| **localhost（ローカルホスト）** | 「今使っているこのパソコン」を指す特別な住所です。ブラウザで localhost のアドレスを開くと、同じパソコンで動かしている抽選アプリが表示されます。 |
| **プロジェクト / プロジェクトフォルダ** | LUCKY DRAW のファイルが入っているフォルダ（lucky-draw という名前のフォルダ）のことです。 |

---

## 1. はじめに用意するもの

- **パソコン**（Windows でも Mac でも使えます）
- **Node.js（ノード・ジェイエス）**  
  → 抽選アプリを動かすために必要なソフトです。まだ入っていない場合は、あとで「2-1. Node.js を入れる」の手順でインストールします。
- **LUCKY DRAW のファイル一式**  
  → 会社で共有されている「lucky-draw」のフォルダを、Git で受け取るか、ZIP で受け取って解凍したもの。

---

## 2. プロジェクト（lucky-draw のフォルダ）を手元に置く

### 2-1. Node.js を入れる（まだ入っていない人だけ）

1. ブラウザで **https://nodejs.org/** を開きます。
2. 画面に **「LTS」** と書いてある緑色のボタン（「推奨版」など）をクリックして、インストール用のファイルをダウンロードします。
3. ダウンロードしたファイルを開き、表示される手順に従って「次へ」などで進め、最後までインストールします。
4. **インストール後、一度パソコンを再起動**すると安心です（ターミナルを開く前に）。

**入っているか確認したいとき**  
ターミナル（後述）を開き、`node -v` と入力して Enter を押すと、バージョン番号（例：v20.10.0）が表示されれば入っています。何も出ない・「コマンドが見つかりません」と出る場合は、上記のインストールをもう一度行ってください。

---

### 2-2. 「ターミナル」を開く

このあと、黒い画面に文字を入力していきます。その画面の開き方です。

- **Mac の場合**  
  -  Spotlight（虫眼鏡アイコン）で「ターミナル」と入力して、出てきた「ターミナル」をクリックする  
  - または「アプリケーション」→「ユーティリティ」→「ターミナル」を開く
- **Windows の場合**  
  - スタートメニューで「cmd」または「コマンドプロンプト」と入力し、表示された「コマンドプロンプト」をクリックする  
  - または「Windows キー + R」を押し、「cmd」と入力して Enter を押す

開いたら、**今いる場所（フォルダ）を、lucky-draw のフォルダの中に変えます**。

---

### 2-3. lucky-draw のフォルダに移動する

1. lucky-draw のフォルダがどこにあるか確認します。  
   - 例：デスクトップに「lucky-draw」フォルダがある場合  
   - 例：ダウンロードした ZIP を解凍して「lucky-draw」という名前のフォルダになっている場合
2. ターミナルで、次のように入力します（**あなたのフォルダの場所に合わせて、パスを書き換えてください**）。  
   - **Mac の例**（デスクトップにある場合）：  
     `cd ~/Desktop/lucky-draw`  
   - **Windows の例**（デスクトップにある場合）：  
     `cd Desktop\lucky-draw`  
   - フォルダが別の場所（例：ドキュメント内）にある場合は、  
     `cd` のうしろを、そのフォルダまでの道のりに書き換えます。  
     ※ わからない場合は、エクスプローラー（Finder）で lucky-draw フォルダを開き、アドレスバーに表示されているパスを参考にしてください。
3. **Enter キー**を押します。
4. 次のコマンドを打つ前に、**今の行の前にフォルダのパスが表示されていること**を確認します。これで「lucky-draw の中にいる」状態になっています。

**ZIP で受け取った場合**  
ZIP を解凍すると「lucky-draw」という名前のフォルダが出てきます。その**中身**（index.html や script.js などが見えるところ）が、このマニュアルで言う「lucky-draw のフォルダ」です。ターミナルでは、その「lucky-draw」フォルダに `cd` で移動してください。

---

### 2-4. Git で受け取った場合（担当者から「リポジトリの URL」をもらっている人）

担当者から「この URL をクローンして」と言われている場合は、次のようにします。

1. ターミナルで、lucky-draw を置きたい場所（例：デスクトップ）に移動します。  
   - Mac 例：`cd ~/Desktop`  
   - Windows 例：`cd Desktop`
2. 次のコマンドを、**もらった URL に書き換えて**入力し、Enter を押します。  
   `git clone ここにリポジトリのURLを貼り付け`
   - 例：`git clone https://github.com/会社名/lucky-draw.git`
3. 処理が終わると、その場所に「lucky-draw」フォルダができます。
4. その後、上記 2-3 と同様に、`cd lucky-draw`（または `cd Desktop\lucky-draw` など）で、lucky-draw の**中**に移動します。

---

## 3. 抽選アプリを起動する

ここでは、**「ターミナルで 2 つのコマンドを順番に打つ」**だけで、抽選アプリを立ち上げます。

### 3-1. 初回だけ：必要な部品を入れる（npm install）

1. ターミナルで、**lucky-draw のフォルダの中にいる**ことを確認します（前の手順の 2-3 の状態）。
2. 次の文字を**そのままコピー**し、ターミナルに**貼り付けて** Enter を押します。  
   `npm install`
3. 数十秒〜数分、文字が流れます。最後にエラーのような赤い文字が出ていなければ成功です。  
   ※ 初回だけ行えば十分です。2回目以降の起動では、この手順は不要です。

---

### 3-2. アプリを起動する（npm run dev）

1. 同じく、lucky-draw のフォルダの中にいる状態で、次の文字を**そのままコピー**して貼り付け、Enter を押します。  
   `npm run dev`
2. しばらくすると、ターミナルに次のような表示が出ます。  
   `http://localhost:3000` や `Local: http://localhost:3000/` のような行です。
3. **この「http://localhost:3000」の部分をコピー**します。
4. **ブラウザ**（Chrome や Edge など）を開き、**アドレスバー**（URL を入力する一番上の欄）に、コピーした `http://localhost:3000` を貼り付けて Enter を押します。
5. 抽選画面（リールや START ボタンが見える画面）が表示されれば、起動成功です。

**大切な注意**  
- 抽選アプリは、**index.html などのファイルをダブルクリックして開いてはいけません**。  
- 必ず「ターミナルで `npm run dev` を実行したあと、ブラウザで http://localhost:3000 を開く」ようにしてください。  
  そうしないと、賞品リストの読み込みなどができません。

---

### 3-3. 起動を止めるとき

抽選アプリを終了したいときは、**ターミナルの画面をクリックしてから**、次のキーを押します。

- **Windows**：**Ctrl + C**
- **Mac**：**Control + C**（Ctrl ではなく、キーボードの「control」キー）

ターミナルにまた入力できる状態になれば、アプリは止まっています。ブラウザのタブを閉じてもかまいません。

---

## 4. 賞品リスト（スプレッドシート）を用意する

賞品の一覧は **Google スプレッドシート**で管理します。  
「どの賞品が何個あるか」「大当たりかどうか」などをスプシに書いておき、アプリの「更新」ボタンで読み込む、という流れです。

### 4-1. スプレッドシートに書く内容（形式A・推奨）

1行目は**見出し**、2行目以降に**賞品のデータ**を書きます。

| 列 | 意味 | 入力例 |
|----|------|--------|
| **A列：レート** | 景品のランク | `mega`（一番豪華） / `super` / `big` / `normal`（通常） のどれか1つを英語で |
| **B列：賞品名** | 画面に表示する名前 | 例：〇〇グッズ、△△シール |
| **C列：本数** | その賞品の在庫数（何回抽選で当たるか） | 数字だけ。例：1、2、10 |
| **D列：画像** | 画像の指定（後述） | 後で説明する「画像のセット方法」のどれかで記入。空欄でも可 |

**入力例（2行目以降）**

| A列 | B列 | C列 | D列 |
|-----|-----|-----|-----|
| mega | 特製グッズ | 1 | LD_0001 |
| super | シール | 2 | 2 |
| big | チョコ | 5 | （空欄） |
| normal | キャラシール | 10 | （空欄） |

※ D列は、あとで説明する「画像のセット方法」に従って書きます。画像がない賞品は空欄でかまいません。

---

### 4-2. 別の形式（管理No. 形式）を使う場合

すでに「管理No.」「賞品レート」「商品名」「当選個数」「画像No」などの列があるスプシを使う場合も対応しています。

- **画像**は、そのスプシでは **F列（画像No）** に書く形になります。
- 書く内容は、後述の「画像のセット方法」と同じです（例：`LD_0001` や `1`）。

---

### 4-3. アプリでスプレッドシートを読み込む手順

1. 抽選アプリを起動した状態で、画面**右上**の **⚙ 設定** ボタンをクリックします。
2. 設定のウィンドウが開いたら、上にある **「賞品 一覧」** というタブをクリックします。
3. **「📊 スプシを開く」** の青いボタンを押すと、現在設定されているスプレッドシートがブラウザで開きます。  
   ※ 会社で「このスプシを使ってください」と指定されている場合は、そのスプシの URL を担当者に教えてもらい、必要なら担当者に「アプリから開くスプシを、この URL に変えてほしい」と依頼してください。
4. スプレッドシートの**共有設定**を次のどちらかにします。  
   - 「**リンクを知っている全員が閲覧可**」  
   - または「**ウェブに公開**」（「全員」で公開）  
   こうしないと、アプリから賞品リストを読み込めない場合があります。
5. アプリの設定画面に戻り、**「🔄 更新」** ボタンをクリックします。
6. 「〇〇本の賞品を読み込みました」のようなメッセージが出れば成功です。リールに賞品が並んで表示されます。

---

## 5. 画像のセット方法

画像がなくても抽選はできます（賞品名だけ表示されます）。  
画像を表示したい場合は、次の **①・②・③** のどれかでセットします。自分がやりやすい方法を選んでください。

---

### 5-1. 方法①：プロジェクト内の「prize_pics」フォルダに画像を置く（いちばん確実）

画像ファイルを**手元のパソコン**に持っているときに使う方法です。

#### 手順

1. **lucky-draw のフォルダ**を開きます（エクスプローラーや Finder で）。
2. その中にある **「prize_pics」** という名前のフォルダを開きます。
3. 表示したい画像を、**次のルールのファイル名**でこのフォルダに保存（コピー）します。  
   - **ルール**：`LD_` ＋ **4桁の数字** ＋ **拡張子**  
   - 例：  
     - 1番の画像 → `LD_0001.png` または `LD_0001.jpg`  
     - 11番の画像 → `LD_0011.png` または `LD_0011.JPG`  
     - 25番の画像 → `LD_0025.jpg`  
   - 使える拡張子：`.png` / `.jpg` / `.jpeg`（大文字・小文字どちらでも可）
4. **スプレッドシート**の**画像の列**（形式Aなら D列、形式Bなら F列）に、次のどちらかを書きます。  
   - **`LD_0001`**（4桁の数字部分をゼロ埋め）  
   - または **`1`** だけ（数字だけでも、自動で LD_0001 として扱います）  
   例：2番の画像なら `LD_0002` または `2`、11番なら `LD_0011` または `11`
5. アプリの **設定 → 賞品 一覧 →「🔄 更新」** を押すと、リールに画像が表示されます。

**画像の仕様（デザイナーに発注する場合）**  
- **正方形**（縦と横が同じ長さ）で作ってもらってください。  
- 推奨サイズ：**512×512 ピクセル**（または 256×256 以上）。  
- 形式：PNG または JPG。  
詳しくは、同じ docs フォルダ内の「REEL_IMAGE_SPEC.md」をデザイナーに渡してください。

---

### 5-2. 方法②：スプレッドシートに「画像の URL」を書く

画像を **インターネット上**（Google ドライブや会社のサーバーなど）に置いているときに使う方法です。

#### 手順

1. 画像を **Web 上に置く**（Google ドライブにアップロードする、など）。
2. **その画像を、リンクを知っている人なら誰でも見られるように**設定します。  
   - Google ドライブの場合：「ファイルを右クリック」→「共有」→「リンクを知っている全員が閲覧可」にする。
3. 画像の **URL（アドレス）** をコピーします。  
   - Google ドライブの場合：「リンクをコピー」で出てくる長い URL でかまいません。アプリが自動で表示用の形式に変換します。
4. **スプレッドシート**の**画像の列**（形式Aなら D列）の、その賞品の行に、コピーした **URL をそのまま貼り付け**ます。
5. アプリの **設定 → 賞品 一覧 →「🔄 更新」** を押します。

**うまく表示されないとき**  
- 共有設定が「リンクを知っている全員が閲覧可」になっているか確認してください。  
- その URL をブラウザのアドレスバーに貼り付けて Enter を押し、画像が開けるかも確認してください。

---

### 5-3. 方法③：アプリの設定画面から、画像をアップロードする or URL を貼る

すでに賞品リストを読み込んだあとで、「この賞品の画像だけ差し替えたい」「後から画像を足したい」ときに使う方法です。

#### 手順

1. 抽選アプリを起動した状態で、**⚙ 設定** → **賞品 一覧** を開きます。
2. 賞品が一覧で並んでいます。各賞品のカードに、小さなボタンがあります。  
   - **📷（カメラマーク）** … パソコン内の画像ファイルを選んで、その賞品の画像として設定する  
   - **🔗（リンクマーク）** … 画像の URL を入力する窓が出るので、そこに貼り付けて設定する  
   - **📌（ピンマーク）** … 同じ賞品が複数スロットあるときに、「今の画像を、その賞品の全スロットに共通で使う」ときに押す
3. 📷 の場合は、クリックすると「ファイルを選んでください」のような画面になるので、使いたい画像ファイルを選びます。  
   🔗 の場合は、出てきた窓に画像の URL を貼り付けて OK を押します。
4. 設定画面の下にある **「保存」** を押すと、その賞品の画像がアプリに保存され、リールや当選表示に反映されます。

※ あとでスプレッドシートの「🔄 更新」を押すと、**スプシに書いてある画像（URL や LD_0001 など）が優先**されます。アプリで設定した画像を残したい場合は、スプシの画像の列も同じように書いておくか、更新したあとに再度 📷 や 🔗 で設定し直してください。

---

## 6. うまくいかないとき（よくあるトラブル）

| こんなとき | やってみること |
|------------|----------------|
| **賞品が読み込めない／「読み込み中」のまま止まる** | ① スプレッドシートの共有を「リンクを知っている全員が閲覧可」または「ウェブに公開」にする。② ブラウザで **http://localhost:3000** を開いているか確認する（ファイルをダブルクリックして開いただけの画面では読み込めません）。③ ターミナルで `npm run dev` を実行したままになっているか確認する。 |
| **画像が表示されない** | ① prize_pics を使っている場合：ファイル名が `LD_0001.png` の形か、スプシの画像の列に `LD_0001` や `1` と書いてあるか確認。② URL を使っている場合：その URL をブラウザで開いて、画像が見えるか確認。共有設定を「閲覧可」にする。 |
| **「npm がわかりません」「コマンドが見つかりません」と出る** | Node.js が入っていない可能性があります。「2-1. Node.js を入れる」の手順でインストールし、パソコンを再起動してから、もう一度 `npm install` と `npm run dev` を試してください。 |
| **別のパソコンで開くと、履歴や設定が違う** | このローカル版では、設定や抽選履歴は **そのパソコンのブラウザにだけ** 保存されます。別のパソコンと内容をそろえたい場合は、担当者に「lucky-draw-cloud（クラウド版）」の利用可否を相談してください。 |

---

## 7. 本番で使うときの流れ（おさらい）

1. **起動**  
   ターミナルで lucky-draw のフォルダに移動 → `npm run dev` を実行 → ブラウザで http://localhost:3000 を開く。
2. **賞品リスト**  
   スプレッドシートを用意し、設定 → 賞品 一覧 →「🔄 更新」で読み込む。
3. **画像**  
   方法①・②・③のどれかで画像をセットし、必要なら「🔄 更新」や「保存」をする。
4. **設定**  
   必要に応じて、設定で「ブランド名」「イベント名」「止まるマス数」「標準／サクサク」などを変え、「保存」する。
5. **抽選**  
   **START** を押してリールを回し、**STOP** で止めて当選を表示。履歴は画面左の「履歴」ボタンで確認できます。

---

ここまでで、ローカル版の導入と画像のセットは一通りできます。  
手順でわからないところや、エラーが出た場合は、社内の担当者（エンジニアや導入担当）に相談してください。
